<!-- ./templates/analytics.html -->

{% extends "base.html" %}

{% block title %}Analytics - Marketing Automation CRM{% endblock %}

{% block content %}
<div class="analytics-page">
    <h1>Marketing Analytics</h1>
    <p class="subtitle">Campaign performance metrics and insights</p>
    
    {% if overall.total_sent > 0 %}
    <div class="overall-metrics">
        <h2>Overall Performance</h2>
        <div class="metrics-grid">
            <div class="metric-item">
                <h3>{{ overall.total_sent }}</h3>
                <p>Total Emails Sent</p>
            </div>
            <div class="metric-item">
                <h3>{{ overall.total_opened }}</h3>
                <p>Total Opened</p>
            </div>
            <div class="metric-item">
                <h3>{{ overall.total_clicked }}</h3>
                <p>Total Clicked</p>
            </div>
            <div class="metric-item">
                <h3>{{ overall.total_converted }}</h3>
                <p>Total Conversions</p>
            </div>
        </div>
        
        <div class="metrics-grid">
            <div class="metric-item">
                <h3>{{ overall.overall_open_rate }}%</h3>
                <p>Avg Open Rate</p>
            </div>
            <div class="metric-item">
                <h3>{{ overall.overall_click_rate }}%</h3>
                <p>Avg Click-Through Rate</p>
            </div>
            <div class="metric-item">
                <h3>{{ overall.overall_conversion_rate }}%</h3>
                <p>Avg Conversion Rate</p>
            </div>
        </div>
    </div>
    {% endif %}
    
    <div class="campaign-metrics">
        <h2>Campaign Performance</h2>
        
        {% if campaign_metrics %}
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Campaign</th>
                        <th>Status</th>
                        <th>Sent</th>
                        <th>Opened</th>
                        <th>Clicked</th>
                        <th>Converted</th>
                        <th>Open Rate</th>
                        <th>CTR</th>
                        <th>Conv. Rate</th>
                    </tr>
                </thead>
                <tbody>
                    {% for metrics in campaign_metrics %}
                    <tr>
                        <td>
                            <a href="{{ url_for('marketing.campaign_detail', campaign_id=metrics.campaign_id) }}">
                                {{ metrics.campaign_name }}
                            </a>
                        </td>
                        <td>
                            {% if metrics.status == 'draft' %}
                                <span class="status-badge status-draft">Draft</span>
                            {% elif metrics.status == 'sent' %}
                                <span class="status-badge status-sent">Sent</span>
                            {% else %}
                                <span class="status-badge">{{ metrics.status }}</span>
                            {% endif %}
                        </td>
                        <td>{{ metrics.sent }}</td>
                        <td>{{ metrics.opened }}</td>
                        <td>{{ metrics.clicked }}</td>
                        <td>{{ metrics.converted }}</td>
                        <td>{{ metrics.open_rate }}%</td>
                        <td>{{ metrics.click_rate }}%</td>
                        <td>{{ metrics.conversion_rate }}%</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="empty-state">
            <p>No campaign data available yet.</p>
            <p>Create and send campaigns to see analytics here.</p>
            <a href="{{ url_for('marketing.campaigns') }}" class="btn btn-primary">Go to Campaigns</a>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
